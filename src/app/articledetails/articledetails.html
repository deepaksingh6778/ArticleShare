<div class="container">

  <!-- Top Bar -->
  <div class="top-bar">

    <!-- Back Button -->
    <div class="back-container" (click)="goBack()">
    <svg width="48" height="48" viewBox="0 0 48 48" fill="none"
        xmlns="http://www.w3.org/2000/svg">

    <!-- White background with black border -->
    <circle cx="24" cy="24" r="22" fill="white" stroke="black" stroke-width="2"/>

    <!-- Straight left arrow -->
    <path d="M30 24H18" 
            stroke="black" 
            stroke-width="3" 
            stroke-linecap="round"/>

    <path d="M22 20L18 24L22 28" 
            stroke="black" 
            stroke-width="3" 
            stroke-linecap="round" 
            stroke-linejoin="round"/>
    </svg>

    </div>

    <span class="spacer"></span>

    <!-- Notifications -->
    <button class="icon-btn">
      <svg width="22" viewBox="0 0 24 24"><path d="M12 22a2 2 0 002-2H10a2 2 0 002 2zm6-6V11a6 6 0 00-4-5.659V4a2 2 0 10-4 0v1.341A6 6 0 006 11v5L4 18v1h16v-1z"/></svg>
    </button>

    <!-- Avatar -->
    <button class="avatar-btn">
      <svg width="30" viewBox="0 0 24 24">
        <circle cx="12" cy="8" r="4" />
        <path d="M4 20c0-4 4-6 8-6s8 2 8 6" />
      </svg>
    </button>

  </div>

  <!-- Article Header -->
  <div class="article-header">

    <div class="header-top-row">
      <div class="tags-container">
        <span class="tag" *ngFor="let tag of article.tags">{{ tag }}</span>
      </div>
      <p class="date">{{ article.date }}</p>
    </div>

    <h1>{{ article.title }}</h1>

    <div class="author-row">
      <svg width="26" viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20c0-4 4-6 8-6s8 2 8 6"/></svg>
      <div>
        <p class="author-name">{{ article.author.name }}</p>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats-row" title="views">
      <div>
        <svg width="20" viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8S1 12 1 12z"/><circle cx="12" cy="12" r="3"/></svg>
        {{ article.views }}
      </div>

      <div (click)="incrementLikes()" title="Likes">
        <svg width="20" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5a5.5 5.5 0 0111 0 5.5 5.5 0 0111 0c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
        {{ article.likes }}
      </div>

      <div (click)="toggleComments()" title="Comments">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="25" fill="none">
          <!-- Left bubble -->
          <path d="M4 6h14c1.1 0 2 .9 2 2v8c0 1.1-.9 2-2 2H10l-4 4v-4H4c-1.1 0-2-.9-2-2V8c0-1.1.9-2 2-2z"
                stroke="black" stroke-width="1.8" stroke-linejoin="round"/>

          <!-- Right bubble -->
          <path d="M28 10H14c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h6l4 4v-4h4c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2z"
                stroke="black" stroke-width="1.8" stroke-linejoin="round"/>
        </svg>
      </div> 
    </div>

  </div>

  <!-- Hero Image -->
  <div class="hero-image">
    <img [src]="article.image" (error)="$event.target.src = 'assets/default.png'" />
  </div>

  <!-- Article Content -->
  <div class="article-content">

   <div [innerHTML]="article.description"></div>

  </div>

  <!-- Recommended Section -->
  <h2 class="recommend-title">Recommend to you</h2>

  <div class="recommended-grid">
    <div class="rec-card" *ngFor="let item of recommended">
      <div class="rec-image" (click)="navigateToArticleDetails(item.id)" style="cursor: pointer;">
        <img [src]="item.image" (error)="$event.target.src = 'assets/default.png'"  />
      </div>
      <p class="rec-title">{{ item.title }}</p>
    </div>
  </div>

</div>
<!-- Background Overlay -->
<div class="overlay" *ngIf="showComments" (click)="toggleComments()"></div>

<!-- Comment Panel -->
<div class="comment-panel" [class.open]="showComments">

  <div class="panel-header">
    <h2>Comment ({{ commentCount }})</h2>
    <button class="close-btn" (click)="toggleComments()">
      <svg width="24" viewBox="0 0 24 24">
        <path d="M6 6l12 12M6 18l12-12" stroke-width="2" stroke="#333"/>
      </svg>
    </button>
  </div>

  <!-- Add Comment Input -->
  <div class="add-comment">
    <div class="avatar">A</div>
    <input type="text" placeholder="Write a comment..." [(ngModel)]="newCommentText" />
    <button class="post-btn" (click)="postComment()">Post</button>
  </div>

  <hr />

  <!-- Sorting -->
  <div class="sort-row">
    Most relevant â–¾
  </div>

  <!-- Comment List -->
  <div class="comment-list">
    <div class="comment" *ngFor="let c of comments">

      <div class="comment-header">
        <strong>{{ c.author }}</strong>
        <span class="time">{{ c.time }}</span>
      </div>

      <p class="comment-text">{{ c.text }}</p>

      <button class="reply-btn" (click)="startReply(c.id)">Reply</button>

      <!-- Reply Input -->
      <div class="add-comment reply-input" *ngIf="replyingToCommentId === c.id">
        <div class="avatar">A</div>
        <input type="text" placeholder="Write a reply..." [(ngModel)]="newReplyText" />
        <button class="post-btn" (click)="postReply(c.id, replyingToCommentId)">Post Reply</button>
        <button class="cancel-btn" (click)="cancelReply()">Cancel</button>
      </div>

      <!-- Replies -->
      <div class="replies-container" *ngIf="c.replies && c.replies.length > 0">
        <div class="reply" *ngFor="let r of c.replies">
          <div class="comment-header">
            <strong>{{ r.author }}</strong>
            <span class="role" *ngIf="r.role">Author</span>
            <span class="time">{{ r.time }}</span>
          </div>
          <p class="comment-text">{{ r.text }}</p>
          <button class="reply-btn" (click)="startReply(c.id, r.id)">Reply</button>
        </div>
      </div>

    </div>

    <button class="show-more" *ngIf="hasMoreComments" (click)="loadMoreComments()">Show more discussion</button>
  </div>

</div>
